#A bunch of class methods should be refactored into a module here